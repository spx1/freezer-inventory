<!DOCTYPE html>
<html lang="en">
<head>
    <title>Freezer Inventory</title>
    <script>
        function removeOnClickHandler(url) {
            data = {
                active: false
            };
            xhtml = new XMLHttpRequest();
            xhtml.onreadystatechange = function() {
                if(this.readyState == 4 && this.status == 200) {
                    window.location.href = "{{url_for('Inventory.get_application_page')}}";
                }
            }
            xhtml.open('PUT',url);
            xhtml.send(JSON.stringify(data));
        };
    </script>
</head>
<body>
    <h1>Freezer Inventory</h1>
    <table class="table" id="inventory-table">
        <tr>
            <th></th> <!--Placeholder for Remove Button-->
            <th>Category</th>
            <th>Name</th>
            <th>Weight/Count</th>
            <th>Added</th>
        </tr>
        {% for j in items %}
        <tr>
            <td>
                <button onclick="removeOnClickHandler('{{url_for('Inventory.put_item', id=j['id'])}}')">Remove</button>
            </td>
            <td>{{j['category']['name']}}</td>
            <td>{{j['name']}}</td>
            <td>
                {% if j['weight'] is not none %}
                {{ j['weight'] }} lbs
                {% elif j['count'] is not none %}
                {{ j['count'] }} cnt
                {% else %}
                N/A
                {% endif %}
            </td>
            <td>{{j['added']}}</td>
        </tr>
        {% endfor %}
    </table>

    <form method="POST" action="{{url_for('Inventory.post_item')}}">
        {{ form.csrf_token }}
        {{ form.category.label }} {{ form.category(size=20) }}
        {{ form.name.label }} {{ form.name(size=20) }}
        {{ form.weight.label }} {{ form.weight }}
        {{ form.count.label }} {{ form.count }}
        <input type="submit" value="GO">        
    </form>

    {% if form.name.errors %}
        <ul class="errors">
            {% for error in form.name.errors %}
                <li>{{ error }}</li>
            {% endfor %}
        </ul>
    {% endif %}

</body>
</html>